<!-- i used this componenet for admin so the nav bar should not appear in the dashboard -->
<app-nav-bar *ngIf="!IsAdmin"></app-nav-bar>
<p-toast />
<div class="col text-center">
    <h1 class="mt-5"><i class="pi pi-bars" style="font-size: 1rem"></i> Approval Queue List</h1>
</div>
<p-divider></p-divider>
<div class="container-fluid">


    <div class="d-flex justify-content-between align-items-center mb-3">
        <!-- Filter Dropdown -->
        <div>
            <p-dropdown [options]="filterOptions" [(ngModel)]="selectedFilter" optionLabel="label" optionValue="value"
                placeholder="Filter by Approval Status" (onChange)="filterRequests()"></p-dropdown>
        </div>
        <div class="flex-auto">
            <p-calendar class="ml-2" [(ngModel)]="date1" [iconDisplay]="'input'" [showIcon]="true" inputId="icondisplay"
                (onSelect)="filterRequestsByDate()" />
            <button *ngIf="date1" class="btn  ml-2" (click)="clearDate()">
                <i class="pi pi-times" style="color: #EA8300"></i>
            </button>
        </div>
        <!-- Search Bar -->
        <div class="search-bar">
            <mat-form-field appearance="fill" class="search-field">
                <mat-label>Search by User FullName</mat-label>
                <input matInput [(ngModel)]="searchTerm" name="nameOfUser" placeholder="Fullname">
            </mat-form-field>
        </div>
    </div>

    <p-divider type="dashed"></p-divider>

    <p-table [value]="(filteredRequestList| requestFilter:searchTerm)|| []" dataKey="equipmentRequestId"
        [tableStyle]="{ 'min-width': '60rem' }" [rows]="10" [paginator]="true" [rowsPerPageOptions]="[5, 10, 20]">

        <ng-template pTemplate="header">
            <tr>
                <th style="width: 5rem;background-color: #769ef55f;"></th>
                <th style="background-color: #769ef55f;" pSortableColumn="equipmentRequestId"># Request Number
                    <p-sortIcon field="equipmentRequestId" />
                </th>
                <th style="background-color: #769ef55f;" pSortableColumn="nmaeOfUser">By <p-sortIcon
                        field="nmaeOfUser" /></th>
                <th style="background-color: #769ef55f;" pSortableColumn="requestDate">Request Date <p-sortIcon
                        field="requestDate" /></th>
                <th style="background-color: #769ef55f;" pSortableColumn="requestStatus">Status <p-sortIcon
                        field="requestStatus" /></th>
                <th style="background-color: #769ef55f;" pSortableColumn="totalPrice">Total Price <p-sortIcon
                        field="totalPrice" /></th>

                <th style="background-color: #769ef55f;" pSortableColumn="actions">Actions <p-sortIcon
                        field="actions" /></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-request let-expanded="expanded">
            <tr>
                <td>
                    <p-button type="button" pRipple [pRowToggler]="request" [text]="true" [rounded]="true"
                        [plain]="true" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'" />
                </td>
                <td>{{ request.equipmentRequestId }}</td>
                <td>{{ request.nmaeOfUser }}</td>

                <td>{{ request.requestDate | date:'dd/MM/yyyy hh:mm' }}</td>


                <td>
                    <p-tag [rounded]="true" [value]="getRequestStatus(request)" [severity]="getRequestStatus(request) === 'Approved' ? 'success' :
                        getRequestStatus(request) === 'Open' ? 'info' :
                        getRequestStatus(request) === 'Pending' ? 'secondary' :
                        getRequestStatus(request) === 'Partly Approved' ? 'warning' :
                        getRequestStatus(request) === 'Rejected' ? 'danger' : 'info'" />
                </td>
                <td>{{ request.totalPrice }} {{request.currency}}</td>

                <td>
                    <div class="flex-container">
                        


                        <p-button icon="pi pi-arrow-up-right" label="Details" severity="warning"
                            (onClick)="showDialog('request',request)" [outlined]="true"></p-button>
                    </div>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="rowexpansion" let-request>
            <tr>
                <td colspan="7">
                    <div class="p-3">
                        <p-table [value]="request.equipmentSubRequests" dataKey="subEquipmentRequestId">
                            <ng-template pTemplate="header">
            <tr>
                <th style="background-color: #ea85005f;" pSortableColumn="equipementName">Asset <p-sortIcon
                        field="equipementName" /></th>
                <th style="background-color: #ea85005f;" pSortableColumn="qtEquipment">Quantity
                    <p-sortIcon field="qtEquipment" />
                </th>
                <th style="background-color: #ea85005f;" pSortableColumn="pu">Unit price
                    <p-sortIcon field="pu" />
                </th>
                <th style="background-color: #ea85005f;" pSortableColumn="DepartementManager">
                    Department Manager <p-sortIcon field="DepartementManager" /></th>
                <th style="background-color: #ea85005f;" pSortableColumn="ItApprover">IT approval
                    <p-sortIcon field="ItApprover" />
                </th>
                <th style="background-color: #ea85005f;" pSortableColumn="Controller">Finance approval
                    <p-sortIcon field="Controller" />
                </th>
                <th style="background-color: #ea85005f;" pSortableColumn="Controller">PR approval
                    <p-sortIcon field="Controller" />
                </th>
                <th style="background-color: #ea85005f;" pSortableColumn="subRequestStatus">Status
                    <p-sortIcon field="subRequestStatus" />
                </th>
                <th style="background-color: #ea85005f;" pSortableColumn="actions">Actions
                    <p-sortIcon field="actions" />
                </th>

            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-subRequest>
            <tr>
                <td>{{ subRequest.equipementName }}</td>
                <td>{{ subRequest.qtEquipment }}</td>
                <td>{{ subRequest.pu }} {{request.currency}}</td>
                <td>
                    <span class="status-text" [ngClass]="{
                                            'approved': subRequest.departmangconfirmStatus === true,
                                            'rejected': subRequest.departmangconfirmStatus === false,
                                            'open': subRequest.departmangconfirmStatus === null
                                          }">
                        {{ subRequest.departmangconfirmStatus === true ? 'Approved' : subRequest.departmangconfirmStatus
                        === false ? 'Rejected' : 'Open' }}
                    </span>
                </td>
                <td>
                    <span class="status-text" [ngClass]="{
                                            'approved': subRequest.iTconfirmSatuts === true,
                                            'rejected': subRequest.iTconfirmSatuts === false,
                                            'offer': request.supplierOffer != null && subRequest.iTconfirmSatuts === null,
                                            'open': subRequest.iTconfirmSatuts === null && request.supplierOffer === null && subRequest.subRequestStatus === null,
                                            'closed': subRequest.departmangconfirmStatus === false || subRequest.iTconfirmSatuts === false
                                        }">
                        {{ subRequest.iTconfirmSatuts === true ? 'Approved' : subRequest.iTconfirmSatuts === false ?
                        'Rejected' : request.supplierOffer != null && subRequest.departmangconfirmStatus === true ?
                        'Offer': subRequest.departmangconfirmStatus === false || subRequest.iTconfirmSatuts ===
                        false?'colsed': 'Open' }}
                    </span>
                </td>
                <td>
                    <span class="status-text" [ngClass]="{
                                            'approved': subRequest.financeconfirmSatuts === true, 
                                            'rejected': subRequest.financeconfirmSatuts === false,
                                            'open': subRequest.financeconfirmSatuts === null,
                                            'closed': subRequest.departmangconfirmStatus === false || subRequest.iTconfirmSatuts === false
                                          }">
                        {{ subRequest.financeconfirmSatuts === true ? 'Approved' : subRequest.financeconfirmSatuts ===
                        false ? 'Rejected': subRequest.departmangconfirmStatus === false || subRequest.iTconfirmSatuts
                        === false?'colsed' : 'Open' }}
                    </span>
                </td>
                <td>
                    {{getPRStatus(subRequest.pR_Status,request)}}
                </td>
                <td>
                    <span class="status-text" [ngClass]="{
                                            'inprogress': subRequest.departmangconfirmStatus === true && subRequest.iTconfirmSatuts === null && request.supplierOffer === null,
                                            'waitingforfinance': subRequest.departmangconfirmStatus === true && request.supplierOffer != null && subRequest.financeconfirmSatuts === null,
                                            'waitingforpr': subRequest.financeconfirmSatuts === true && request.pR_Status === null,
                                            'approved': request.pR_Status === true,
                                            'rejected': subRequest.departmangconfirmStatus === false || subRequest.iTconfirmSatuts === false || subRequest.financeconfirmSatuts === false,
                                            'closed': subRequest.departmangconfirmStatus === false,
                                            'open': subRequest.departmangconfirmStatus === null && subRequest.iTconfirmSatuts === null && subRequest.financeconfirmSatuts === null,
                                            'offer': request.supplierOffer != null && subRequest.iTconfirmSatuts === null
                                          }">
                        {{ subRequest.departmangconfirmStatus === true && subRequest.iTconfirmSatuts === null &&
                        request.supplierOffer === null ? 'In Progress' :
                        subRequest.departmangconfirmStatus === true && request.supplierOffer != null &&
                        subRequest.financeconfirmSatuts === null ? 'Waiting for Finance Approval' :
                        subRequest.financeconfirmSatuts === true && subRequest.pR_Status === null ? 'Waiting for PR' :
                        subRequest.subRequestStatus=== true ? 'Approved' :
                        subRequest.pR_Status=== true && subRequest.poNum===null ? 'Waiting for PO' :
                        subRequest.departmangconfirmStatus === false || subRequest.iTconfirmSatuts === false ||
                        subRequest.financeconfirmSatuts === false ||subRequest.pR_Status === false? 'Rejected' :

                        request.supplierOffer != null && subRequest.iTconfirmSatuts === null ? 'Offer' :
                        'Open' }}
                    </span>
                </td>
                <td>

                    <div class="flex-container">

                        <p-button icon="pi pi-arrow-up-right" label="Details" severity="secondary"
                            (onClick)="showDialog('subrequest',subRequest)" [outlined]="true"></p-button>
                    </div>

                </td>
            </tr>
        </ng-template>
    </p-table>
</div>
</td>
</tr>
</ng-template>


</p-table>
<div *ngIf="loading" class="text-center">
    <p-progressSpinner styleClass="w-4rem h-4rem" strokeWidth="8" fill="var(--surface-ground)"
        animationDuration=".5s" />
    <!-- or any loading indicator/message you prefer -->
    <p>Fetching data...</p>
</div>

<p-dialog header="{{ mode === 'request' ? 'Request Details'  : 'Request Assets Details' }}" [modal]="true"
    [(visible)]="visible" [style]="{width: '70vw',height:'35vw'}">

    <div *ngIf="mode === 'request'">
        <ng-container>
            <p-panel header="Request {{ selectedRequest.equipmentRequestId }}">
                <div class="form-row">
                    <div class="form-group">
                        <p> <i class="pi pi-user" style="color: #EA8300"></i> <strong> By:</strong> {{
                            selectedRequest.nmaeOfUser }}</p>
                    </div>
                    <div class="form-group">
                        <p> <i class="pi pi-caret-right" style="color: #EA8300"></i><strong> For:</strong>
                           
                            ({{selectedRequest.forWho  }}) 
                            @if(selectedRequest.forWho=='For Another Employee'){
                            {{selectedRequest.newHireName}}
                        }
                        </p>
                    </div>
                    <div class="form-group">
                        <p> <i class="pi pi-hashtag" style="color: #EA8300"></i> <strong> Sap Number:</strong> {{
                            selectedRequest.sapNumOfUser
                            }}</p>
                    </div>
                    <div class="form-group">
                        <p> <i class="pi pi-calendar" style="color: #EA8300"></i> <strong> Request Date:</strong> {{
                            selectedRequest.requestDate | date:'dd/MM/yyyy hh:mm' }}</p>
                    </div>

                    <div class="form-group">
                        <p> <i class="pi pi-inbox" style="color: #EA8300"></i><strong> Status:</strong> {{
                            getRequestStatus(selectedRequest) }}</p>
                    </div>
                    <div class="form-group">
                        <p-divider></p-divider>
                        <div class="col justify-content-end">
                            <p-inplace *ngIf="selectedRequest.supplierOffer != null" closable="closable"
                                class="custom-inplace">
                                <ng-template pTemplate="display">
                                    <div class="inline-flex align-items-center">
                                        <span class="pi pi-file-pdf custom-icon" style="vertical-align: middle;"></span>
                                        <span class="ml-2 custom-text">View Supplier Offer</span>
                                    </div>
                                </ng-template>
                                <ng-template pTemplate="content">
                                    <iframe [src]="loadPdf(selectedRequest.supplierOffer)" width="100%" height="600px"
                                        class="custom-iframe"></iframe>
                                </ng-template>
                            </p-inplace>
                        </div>
                    </div>
                </div>
                <p-divider type="dashed"></p-divider>
                <div style="text-align: right;">
                    <p-button *ngIf="IsItApprover || IsAdmin ||ISitbackupAprover" label="Offer" icon="pi pi-file-pdf" [outlined]="true"
                        (click)="showDialog2('Offer',selectedRequest )" severity="Success"></p-button>
                </div>
                <p-table [value]="selectedRequest.equipmentSubRequests" styleClass="p-datatable-gridlines"
                    [tableStyle]="{ 'min-width': '50rem' }">
                    <ng-template pTemplate="header">
                        <tr>
                            <th>Asset</th>
                            <th>Quantity</th>
                            <th>Department Manager approval</th>
                            <th>IT approval</th>
                            <th>Finance approval</th>
                            <th>PR approval</th>
                            <th>Status</th>
                            <th>Unit Price</th>
                            <th>Total</th>
                            <th>Actions</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-subRequest>
                        <tr>
                            <td>{{ subRequest.equipementName }}</td>
                            <td>{{ subRequest.qtEquipment }}</td>
                            <td>
                                <span class="status-text" [ngClass]="{
                                'approved': subRequest.departmangconfirmStatus === true,
                                'rejected': subRequest.departmangconfirmStatus === false,
                                'open': subRequest.departmangconfirmStatus === null
                                }">
                                    {{ subRequest.departmangconfirmStatus === true ? 'Approved' :
                                    subRequest.departmangconfirmStatus === false ? 'Rejected' : 'Open' }}
                                </span>
                            </td>
                            <td>
                                <span class="status-text" [ngClass]="{
                                'approved': subRequest.iTconfirmSatuts === true,
                                'rejected': subRequest.iTconfirmSatuts === false,
                                'offer': selectedRequest.supplierOffer != null && subRequest.iTconfirmSatuts === null,
                                'open': subRequest.iTconfirmSatuts === null && selectedRequest.supplierOffer === null && subRequest.subRequestStatus === null,
                                'closed': subRequest.departmangconfirmStatus === false || subRequest.iTconfirmSatuts === false
                                }">
                                    {{ subRequest.iTconfirmSatuts === true ? 'Approved' : subRequest.iTconfirmSatuts ===
                                    false ? 'Rejected' : selectedRequest.supplierOffer != null ? 'Offer'
                                    :subRequest.departmangconfirmStatus === false || subRequest.iTconfirmSatuts ===
                                    false
                                    ?'Closed': 'Open' }}
                                </span>
                            </td>
                            <td>
                                <span class="status-text" [ngClass]="{
                                'approved': subRequest.financeconfirmSatuts === true,
                                'rejected': subRequest.financeconfirmSatuts === false,
                                'open': subRequest.financeconfirmSatuts === null,
                                'closed': subRequest.departmangconfirmStatus === false || subRequest.iTconfirmSatuts === false
                                }">
                                    {{ subRequest.financeconfirmSatuts === true ? 'Approved' :
                                    subRequest.financeconfirmSatuts === false ?
                                    'Rejected':subRequest.departmangconfirmStatus === false ||
                                    subRequest.iTconfirmSatuts
                                    === false ?'Closed' : 'Open' }}
                                </span>
                            </td>
                            <td>{{getPRStatus(subRequest.pR_Status,Mainrequest)}}</td>
                            <td>
                                <span class="status-text" [ngClass]="{
                                'inprogress': subRequest.departmangconfirmStatus === true && subRequest.iTconfirmSatuts === null && selectedRequest.supplierOffer === null,
                                'waitingforfinance': subRequest.departmangconfirmStatus === true && selectedRequest.supplierOffer != null && subRequest.financeconfirmSatuts === null,
                                'waitingforpr': subRequest.financeconfirmSatuts === true && subRequest.pR_Status === null,
                                'approved': subRequest.pR_Status === true,
                                'rejected': subRequest.departmangconfirmStatus === false || subRequest.iTconfirmSatuts === false || subRequest.financeconfirmSatuts === false,
                                'closed': subRequest.departmangconfirmStatus === false,
                                'open': subRequest.departmangconfirmStatus === null && subRequest.iTconfirmSatuts === null && subRequest.financeconfirmSatuts === null,
                                'offer': selectedRequest.supplierOffer != null && subRequest.iTconfirmSatuts === null
                            }">
                                    {{ subRequest.departmangconfirmStatus === true && subRequest.iTconfirmSatuts ===
                                    null &&
                                    selectedRequest.supplierOffer === null ? 'In Progress' :
                                    subRequest.departmangconfirmStatus === true && selectedRequest.supplierOffer != null
                                    &&
                                    subRequest.financeconfirmSatuts === null ? 'Waiting for Finance Approval' :
                                    subRequest.financeconfirmSatuts === true && subRequest.pR_Status === null ?
                                    'Waiting for PR':
                                    subRequest.pR_Status=== true && subRequest.poNum===null ? 'Waiting for PO' :
                                    subRequest.pR_Status === true ? 'Approved' :
                                    subRequest.departmangconfirmStatus === false || subRequest.iTconfirmSatuts === false
                                    ||
                                    subRequest.financeconfirmSatuts === false|| subRequest.pR_Status === false  ? 'Rejected' :

                                    selectedRequest.supplierOffer != null && subRequest.iTconfirmSatuts === null ?
                                    'Offer' :
                                    'Open' }}
                                </span>
                            </td>
                            <td>{{ subRequest.pu }} {{selectedRequest.currency}}</td>
                            <td>{{ subRequest.totale }} {{selectedRequest.currency}}</td>
                            <td>

                                <div class="flex-container" *ngIf="subRequest.departmangconfirmStatus !== false && subRequest.iTconfirmSatuts !== false && subRequest.financeconfirmSatuts !== false">
                                    <div >
                                        <p-button *ngIf="IsManger ||ISbackupAprover||IsApprover" icon="pi pi-reply" [outlined]="true" label="Approve"
                                            (click)="showDialog2('approve', subRequest)" severity="Success"></p-button>
                                    </div>
                                    <div >
                                        <p-button *ngIf="IsController ||IScONTROLLERbackupAprover" icon="pi pi-reply" [outlined]="true"
                                            label="Approve" (click)="showDialog2('approveContoller', subRequest)"
                                            severity="Success"></p-button>
                                    </div>
                                    <div  *ngIf="subRequest.financeconfirmSatuts===true">
                                        <p-button *ngIf="IsItApprover ||ISitbackupAprover " label="PR" icon="pi pi-inbox" [outlined]="true"
                                            (click)="showDialog2('PR&PO', subRequest)" severity="Success"></p-button>
                                    </div>

                                    <div  *ngIf="subRequest.pR_Status==true">
                                        <p-button *ngIf="IsItApprover ||ISitbackupAprover" label="PO" icon="pi pi-inbox"
                                            (click)="showDialog2('PO', subRequest)" severity="warning"></p-button>
                                    </div>
                                    <div *ngIf="subRequest.poNum!=null">
                                        <p-button *ngIf="IsItApprover ||ISitbackupAprover" label="Assign" icon="pi pi-user"
                                            (click)="showDialog2('Assign', subRequest)" severity="Success"></p-button>
                                    </div>
                                    <div >
                                        <p-button *ngIf="IsAdmin" label="Approve" icon="pi pi-reply"
                                            (click)="showDialog2('AdminApprove', subRequest)" severity="Success"></p-button>
                                    </div>
                                </div>

                            </td>
                        </tr>

                    </ng-template>
                </p-table>
                <p-divider type="dashed" />

                <div class="total-price-container">
                    <h1>
                        <span>Total Price:</span> {{selectedRequest.totalPrice}} {{selectedRequest.currency}}
                    </h1>
                </div>
            </p-panel>
        </ng-container>
    </div>

    <div *ngIf="mode === 'subrequest'">
        <div class="position-relative">
            <img *ngIf="selectedSubRequest?.subRequestStatus === true" src="/assets/Images/approved.png" width="222rem"
                alt="" style="position: absolute; left: 11px;">
            <img *ngIf="selectedSubRequest?.subRequestStatus === false" src="/assets/Images/rejected.png" width="222rem"
                alt="" style="position: absolute; left: 11px;">
        </div>
        <p-timeline [value]="timelineEvents" align="alternate" *ngIf="selectedSubRequest">
            <ng-template pTemplate="marker" let-event>
                <ng-container *ngIf="event.title === 'Manager approval'">
                    <span *ngIf="event.statusManag === true" class="pi pi-check-circle" style="color:green;"></span>
                    <span *ngIf="event.statusManag === false" class="pi pi-times-circle" style="color:red;"></span>
                    <span *ngIf="event.statusManag === null" class="pi pi-hourglass"
                        style="color:rgba(0, 51, 255, 0.777);"></span>
                </ng-container>
                <ng-container *ngIf="event.title === 'IT approval'">
                    <span *ngIf="selectedSubRequest.iTconfirmSatuts === true" class="pi pi-check-circle"
                        style="color:green;"></span>
                    <span *ngIf="selectedSubRequest.iTconfirmSatuts === false" class="pi pi-times-circle"
                        style="color:red;"></span>
                    <span *ngIf="Mysubrequest.supplierOffer && selectedSubRequest.iTconfirmSatuts === null"
                        class="pi pi-info-circle" style="color:rgb(64, 161, 175);"></span>
                    <span *ngIf="selectedSubRequest.iTconfirmSatuts === null && !Mysubrequest.supplierOffer"
                        class="pi pi-hourglass" style="color:rgba(0, 51, 255, 0.777);"></span>
                </ng-container>
                <ng-container *ngIf="event.title === 'Finance approval'">
                    <span *ngIf="event.statusFina === true" class="pi pi-check-circle" style="color:green;"></span>
                    <span *ngIf="event.statusFina === false" class="pi pi-times-circle" style="color:red;"></span>
                    <span *ngIf="event.statusFina === null" class="pi pi-hourglass"
                        style="color:rgba(0, 51, 255, 0.777);"></span>
                </ng-container>
                <ng-container *ngIf="event.title === 'Asset approval'">
                    <ng-container *ngIf="event.statusreq === true ; else checkInProgress">
                        <span class="pi pi-check-circle" style="color:green;"></span>
                    </ng-container>
                    <ng-template #checkInProgress>
                        <ng-container
                            *ngIf="event.departmangconfirmStatus === false || event.iTconfirmSatuts === false || event.financeconfirmSatuts === false || event.statusreq === false; else checkInProgressFurther">
                            <span class="pi pi-times-circle" style="color:red;"></span>
                        </ng-container>
                        <ng-template #checkInProgressFurther>
                            <ng-container *ngIf="Mysubrequest.supplierOffer !== null; else checkFinanceApproval">
                                <span class="pi pi-info-circle" style="color:rgb(64, 161, 175);"></span>
                            </ng-container>
                            <ng-template #checkFinanceApproval>
                                <ng-container *ngIf="event.financeconfirmSatuts === null; else checkPRApproval">
                                    <span class="pi pi-info-circle" style="color:rgb(64, 161, 175);"></span>
                                </ng-container>
                                <ng-template #checkPRApproval>
                                    <ng-container *ngIf="event.poNum === null; else defaultNotApproved">
                                        <span class="pi pi-info-circle" style="color:rgb(64, 161, 175);"></span>
                                    </ng-container>
                                    <ng-template #defaultNotApproved>
                                        <span class="pi pi-hourglass" style="color:rgb(0, 47, 255);"></span>
                                    </ng-template>
                                </ng-template>
                            </ng-template>
                        </ng-template>
                    </ng-template>
                </ng-container>
            </ng-template>
            <ng-template pTemplate="content" let-event>
                <div class="p-timeline-event-content">
                    <h4 style="color: #104a7c; font-size: 1.2rem;">{{ event.title }}</h4>
                    <p-divider type="dashed" />
                    <p *ngIf="event.date"><b>Date:</b> {{ event.date | date:'dd/MM/yyyy hh:mm' }}</p>
                    <p *ngIf="event.by"><b>By:</b> {{ event.by }}</p>
                    <p *ngIf="event.Equipment"><b>Asset:</b> {{ event.Equipment }}</p>
                    <p *ngIf="event.Quantity"><b>Quantity:</b> {{ event.Quantity }}</p>
                    <p *ngIf="event.PU"><b>Unit Price:</b> {{ event.PU }}</p>
                    <p *ngIf="event.PrStatus"><b>PR Status:</b> {{ event.PrStatus }}</p>
                    <p *ngIf="event.cc"><b>CC:</b> {{ event.cc }}</p>
                    <p *ngIf="event.gl"><b>GL:</b> {{ event.gl }}</p>
                    <p *ngIf="event.order"><b>Order:</b> {{ event.prnum }}</p>
                    <p *ngIf="event.prnum"><b>PR number:</b> {{ event.prnum }}</p>
                    <p *ngIf="event.ponum"><b>PO number:</b> {{ event.ponum }}</p>
                    <p *ngIf="event.Comments"><b>Comment:</b> {{ event.Comments }}</p>
                    <p *ngIf="event.RejectionCause"><b>Cause:</b> {{ event.RejectionCause }}</p>
                    <p *ngIf="event.statusIT === null || event.statusIT !=null"><b>Status:</b> {{ getItStatus() }}</p>
                    <p *ngIf="event.statusFina === null || event.statusFina !=null"><b>Status:</b> {{ getFinanceStatus()
                        }}</p>

                    <p *ngIf="event.statusManag === null || event.statusManag !=null"><b>Status:</b> {{
                        getmanagerStatus()}}</p>

                    <!-- general request -->
                    <p *ngIf="event.statusreq === null || event.statusreq != null"><b>Request Status:</b>
                        {{ getSubRequestStatusGeneral() }}
                    </p>
                    <p *ngIf="event.AssignementStatus !=null"><b>Assigned:</b> {{ event.AssignementStatus === true ? 'Yes':'No' }}
                        <p *ngIf=" event.AssignedAt !=null"><b>Assigned At:</b> {{ event.AssignedAt | date:'dd/MM/yyyy hh:mm'}}</p>
                           
    
                </div>
            </ng-template>
        </p-timeline>
    </div>


    

</p-dialog>
<p-dialog
    header="{{mode2 === 'approve' ? 'Manager Approval' :  mode2 === 'approveContoller' ? 'Finance Approval':  mode2 === 'PO' ? 'PO Approval':mode2 === 'PR&PO' ? 'Pr Approval'  : 'Request Approval' }}"
    [modal]="true" [(visible)]="visible2" [style]="{width: '57vw',height:'39vw'}">

    <div *ngIf="mode2 === 'approve'">
        <div class="w-100">
            <p-divider type="dashed"></p-divider>

            <form (ngSubmit)="ManagerApprve()" class="position-relative" #form="ngForm">
                <h2>Select your response:</h2>
                <p-selectButton [options]="stateOptions" optionLabel="label" optionValue="value"
                    name="departmangconfirmStatus" [(ngModel)]="selectedSubRequest.departmangconfirmStatus" required>
                </p-selectButton>
                <div *ngIf="form.submitted && !selectedSubRequest.departmangconfirmStatus" class="error-message">
                    Response is required.
                </div>
                <br>
                <h2>Enter the cause:</h2>
                <textarea rows="10" cols="70" pInputTextarea name="departmang_Not_confirmCause"
                    [(ngModel)]="selectedSubRequest.departmang_Not_confirmCause" required #cause="ngModel">
                </textarea>
                <div *ngIf="cause.touched && cause.invalid" class="error-message">
                    Cause is required.
                </div>
                <br>
                <div class="position-relative end-0 bottom-0">
                    <p-button type="submit" [outlined]="true" [disabled]="loading2 || form.invalid">
                        <ng-container *ngIf="!loading2; else loadingTemplate">
                            Confirm
                        </ng-container>
                        <ng-template #loadingTemplate>
                            <i class="pi pi-spinner pi-spin"></i> Loading...
                        </ng-template>
                    </p-button>
                </div>
            </form>


        </div>
    </div>
    <div *ngIf="mode2 === 'Offer'">
        <form (ngSubmit)="confirmUploadAndITData()" #Offerform="ngForm">
            <p-stepper>
                <p-stepperPanel header="Supplier Offer">
                    <ng-template pTemplate="content" let-nextCallback="nextCallback" let-index="index">
                        <div class="flex flex-column h-12rem">
                            <div
                                class="border-2 border-dashed surface-border border-round surface-ground justify-content-center align-items-center">
                                <p-fileUpload #fileUpload name="supplierOffer" [multiple]="false"
                                    accept="application/pdf" maxFileSize="1000000" [customUpload]="true"
                                    (uploadHandler)="onFileUpload($event)" (onRemove)="onRemoveFile()">
                                    <ng-template pTemplate="header">
                                        <div
                                            class="flex flex-wrap justify-content-between align-items-center flex-1 gap-2">
                                            <div class="flex gap-2">
                                                <p-button icon="pi pi-file-import" [rounded]="true" [outlined]="true"
                                                    (click)="fileInput.click()"></p-button>
                                                <input type="file" #fileInput style="display:none;"
                                                    (change)="onFileInputChange($event)" name="supplierOffer" />
                                                <p-button icon="pi pi-times" [rounded]="true" [outlined]="true"
                                                    severity="danger" [disabled]="!uploadedFile"
                                                    (click)="onRemoveFile()"></p-button>
                                            </div>
                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="content">
                                        <div *ngIf="uploadedFile" class="p-d-flex p-ai-center">
                                            <iframe [src]="pdfSrc" width="100%" height="600px"></iframe>
                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="empty">
                                        <div class="flex align-items-center justify-content-center flex-column"
                                            *ngIf="!uploadedFile && showDragAndDropArea">
                                            <i
                                                class="pi pi-cloud-upload border-2 border-circle p-5 text-8xl text-400 border-400"></i>
                                            <p class="mt-4 mb-0">Drag and drop a PDF file to upload.</p>
                                        </div>
                                    </ng-template>
                                </p-fileUpload>
                                <div *ngIf="!uploadedFile && Offerform.submitted" class="error-message">File upload is
                                    required.</div>
                            </div>
                            <div class="flex pt-4 justify-content-end">
                                <p-button label="Next" icon="pi pi-arrow-right" iconPos="right"
                                    (click)="nextCallback.emit()"></p-button>
                            </div>
        <p-divider></p-divider>

                        </div>
                    </ng-template>

                </p-stepperPanel>
                <p-stepperPanel header="Price">
                    <ng-template pTemplate="content" let-prevCallback="prevCallback" let-nextCallback="nextCallback"
                        let-index="index">
                        <p-divider></p-divider>
                        <h2> Select the Currency</h2>
                        <div class="flex flex-column h-12rem">
                            <div class=" flex justify-content-center">
                                <div class="flex flex-wrap gap-3">
                                    <div class="flex align-items-center">
                                        <p-radioButton name="currency" value="MAD"
                                            [(ngModel)]="selectedRequest.currency" inputId="ingredient2" />
                                        <label for="ingredient2" class="ml-2">
                                            MAD
                                        </label>
                                    </div>

                                    <div class="flex align-items-center">
                                        <p-radioButton name="currency" value="€" [(ngModel)]="selectedRequest.currency"
                                            inputId="ingredient3" />
                                        <label for="ingredient3" class="ml-2">
                                            €
                                        </label>
                                    </div>

                                    <div class="flex align-items-center">
                                        <p-radioButton name="currency" value="$" [(ngModel)]="selectedRequest.currency"
                                            inputId="ingredient4" />
                                        <label for="ingredient4" class="ml-2">
                                            $
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <p-divider></p-divider>

                            <div
                                class="border-2 border-dashed surface-border border-round surface-ground flex-auto flex justify-content-center align-items-center font-medium">
                                <p-table [value]="approvedSubRequests" styleClass="p-datatable-gridlines">
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th>Asset</th>
                                            <th>Quantity</th>
                                            <th>Unit Price</th>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-asset let-i="rowIndex">
                                        <tr>
                                            <td>{{ asset.equipementName }}</td>
                                            <td>{{ asset.qtEquipment }}</td>
                                            <td>
                                                <input type="text" pInputText name="pu{{i}}"
                                                    [(ngModel)]="asset.pu"
                                                    #pu="ngModel" required />
                                                <div *ngIf="pu.touched && pu.invalid" class="error-message">
                                                    Unit Price is required.
                                                </div>
                                            </td>
                                        </tr>
                                    </ng-template>
                                </p-table>
                            </div>
                            <div class="flex pt-4 justify-content-between">
                                <p-button label="Back" icon="pi pi-arrow-left" (onClick)="prevCallback.emit()" />
                                <p-button type="submit" [outlined]="true" [disabled]="loading3 || Offerform.invalid">
                                    <ng-container *ngIf="!loading3; else loadingTemplate">
                                        Confirm
                                    </ng-container>
                                    <ng-template #loadingTemplate>
                                        <i class="pi pi-spinner pi-spin"></i> Loading...
                                    </ng-template>
                                </p-button>
                            </div>
        <p-divider></p-divider>

                        </div>
                    </ng-template>
                </p-stepperPanel>
            </p-stepper>
        </form>

    </div>
    <div *ngIf="mode2 === 'approveContoller'">
        <div class="w-100">
            <p-divider type="dashed"></p-divider>

            <form (ngSubmit)="ManagerApprve()" class="position-relative" #form="ngForm">
                <h2>Select your response:</h2>
                <p-selectButton [options]="stateOptions" optionLabel="label" optionValue="value"
                    name="financeconfirmSatuts" [(ngModel)]="selectedSubRequest.financeconfirmSatuts" required>
                </p-selectButton>
                <br>
                <div class="container" *ngIf="selectedSubRequest.financeconfirmSatuts===true">
                    <p-divider align="left" type="solid"> <b>GL & CC & Order</b>
                    </p-divider>

                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <input pInputText id="GL" aria-describedby="gl-help" name="gl" placeholder="GL"
                                [(ngModel)]="selectedSubRequest.gl" class="form-control" />
                        </div>
                        <div class="col-md-4 mb-3">
                            <input pInputText id="CC" aria-describedby="CC-help" name="cc" placeholder="CC"
                                [(ngModel)]="selectedSubRequest.cc" class="form-control" />
                        </div>
                        <div class="col-md-4 mb-3">
                            <input pInputText id="order" aria-describedby="order-help" placeholder="Order" name="order"
                                [(ngModel)]="selectedSubRequest.order" class="form-control" />

                        </div>
                    </div>
                </div>
                <p-divider type="solid"> </p-divider>

                <div *ngIf="form.submitted && !selectedSubRequest.financeconfirmSatuts" class="error-message">
                    Response is required.
                </div>
                <br>
                <div *ngIf="selectedSubRequest.financeconfirmSatuts==false">
                <h2  >Enter the cause:</h2>
                <textarea rows="6" cols="50" pInputTextarea name="finance_Not_confirmCause" 
                    [(ngModel)]="selectedSubRequest.finance_Not_confirmCause" required #cause="ngModel">
                </textarea>
            </div>
                <br>
                <div class="position-relative end-2 bottom-2">
                    <p-button type="submit" [outlined]="true" [disabled]="loading2 || form.invalid">
                        <ng-container *ngIf="!loading2; else loadingTemplate">
                            Confirm
                        </ng-container>
                        <ng-template #loadingTemplate>
                            <i class="pi pi-spinner pi-spin"></i> Loading...
                        </ng-template>
                    </p-button>
                </div>
            </form>


        </div>
    </div>
    <div *ngIf="mode2 === 'PR&PO'">
        <div class="w-100">
            <p-divider type="dashed"></p-divider>

            <form (ngSubmit)="ManagerApprve()" class="position-relative" #form="ngForm">
                <h2>Select your response:</h2>
                <p-selectButton [options]="stateOptions" optionLabel="label" optionValue="value" name="pR_Status"
                    [(ngModel)]="selectedSubRequest.pR_Status" required>
                </p-selectButton>
                <div *ngIf="form.submitted && !selectedSubRequest.pR_Status" class="error-message">
                    Response is required.
                </div>
                <br>

                <div *ngIf="selectedSubRequest.pR_Status===true">
                    <p-divider align="left" type="solid"> <b> PR</b>
                    </p-divider>
                    <div class="row">
                        <div class="col-4">
                            <input type="text" pInputText [(ngModel)]="selectedSubRequest.prNum" name="prNum"
                                placeholder="PR number" class="form-control" />
                        </div>

                    </div>
                    <p-divider type="dashed" />
                    <br>
                </div>
                <div *ngIf="selectedSubRequest.pR_Status===false">
                <h2>Enter the cause:</h2>
                <textarea rows="10" cols="70" pInputTextarea name="pR_Not_ConfirmCause" 
                    [(ngModel)]="selectedSubRequest.pR_Not_ConfirmCause" required #cause="ngModel">
                </textarea>
               
            </div>
                <br>
                <div class="position-relative end-0 bottom-0">
                    <p-button type="submit" [outlined]="true" [disabled]="loading2 || form.invalid">
                        <ng-container *ngIf="!loading2; else loadingTemplate">
                            Confirm
                        </ng-container>
                        <ng-template #loadingTemplate>
                            <i class="pi pi-spinner pi-spin"></i> Loading...
                        </ng-template>
                    </p-button>
                </div>
            </form>


        </div>
    </div>
    <div *ngIf="mode2 === 'PO'">
        <div class="w-100">

            <form (ngSubmit)="ManagerApprve()" class="position-relative" #form="ngForm">
                <div *ngIf="selectedSubRequest.pR_Status === true">
                    <p-divider align="left" type="solid"><b>PO</b></p-divider>
                    <div class="row">
                        <div class="form-group">
                            <input type="text" pInputText [(ngModel)]="selectedSubRequest.poNum" name="poNum"
                                placeholder="PO number" class="form-control same-size-input" />
                        </div>
                        <p-divider align="left" type="solid"><b>Supplier</b></p-divider>
                        <div class="form-group mt-3">
                            <p-dropdown [filter]="true" filterBy="supplierName" [showClear]="true"
                                [(ngModel)]="selectedSubRequest.supplierrid" [appendTo]="'body'" name="supplierrid"
                                [options]="supliersNames" optionValue="supplierId" optionLabel="supplierName"
                                aria-describedby="supplierName" placeholder="Select the Supplier Name"
                                class="same-size-dropdown">
                            </p-dropdown>
                        </div>
                    </div>
                    <p-divider type="dashed"></p-divider>
                    <br>
                </div>
                <br>
                <div>
                    <p-button type="submit" [outlined]="true" [disabled]="loading2 || form.invalid">
                        <ng-container *ngIf="!loading2; else loadingTemplate">
                            Confirm
                        </ng-container>
                        <ng-template #loadingTemplate>
                            <i class="pi pi-spinner pi-spin"></i> Loading...
                        </ng-template>
                    </p-button>
                </div>
            </form>


        </div>
    </div>
    <div *ngIf="mode2 === 'Assign'">
        <div class="w-100">

            <form (ngSubmit)="ManagerApprve()" class="position-relative" #form="ngForm">
                <div *ngIf="selectedSubRequest.pR_Status === true">
                    <p-divider align="left" type="solid"><b>Employee</b></p-divider>
                    <div class="row">
                        <div class="row justify-content-center align-items-center text-center">
                            <p-avatar icon="pi pi-user" styleClass="mr-2" size="xlarge" />
                            <h3 class="mt-2">{{Mainrequest.nmaeOfUser}} </h3>
                        </div>
                       
                           
                        <p-divider type="solid"></p-divider>
                        <div class="form-group mt-3">
                            <p-checkbox   inputId="ny" [(ngModel)]="selectedSubRequest.receptionStatus" [binary]="true" name="receptionStatus" />
                            <label for="ny" class="ml-2"> Assign</label>
                        </div>
                        <div class="form-group d-flex align-items-center mt-3">
                            <div class="flex-grow-1 mr-2">
                                <label class="mb-3" for="AssetSN">Assignment Date:</label>

                                <p-calendar [iconDisplay]="'input'" [showIcon]="true" inputId="calendar-24h"
                                            [appendTo]="'body'" name="assetReceiveByEMployeAt"
                                            [(ngModel)]="selectedSubRequest.assetReceiveByEMployeAt" dateFormat="dd-mm-yy" [showTime]="true" [showButtonBar]="true"
                                            class="w-100"/>
                            </div>
                            <div class="flex-grow-1 mr-3">
                                <label class="mb-3" for="AssetSN">Asset SN:</label> 
                                <input type="text" pInputText [(ngModel)]="selectedSubRequest.assetSN" name="AssetSN"
                                       placeholder="Asset Serial Number" class="form-control"/>
                            </div>
                            <div class="flex-grow-1">
                                <label class="mb-3" for="AssetSN">Asset Model:</label>
                                <input type="text" pInputText [(ngModel)]="selectedSubRequest.assetModele" name="AssetModele"
                                       placeholder="Asset Modele" class="form-control"/>
                            </div>
                        </div>

                    </div>
                    <p-divider type="dashed"></p-divider>
                    <br>
                </div>
                <br>
                <div>
                    <p-button type="submit" [outlined]="true" [disabled]="loading2 || form.invalid">
                        <ng-container *ngIf="!loading2; else loadingTemplate">
                            Confirm
                        </ng-container>
                        <ng-template #loadingTemplate>
                            <i class="pi pi-spinner pi-spin"></i> Loading...
                        </ng-template>
                    </p-button>
                </div>
            </form>


        </div>
    </div>

    <div *ngIf="mode2 === 'AdminApprove'">
       <form (ngSubmit)="AdminApprove()" class="position-relative" #form="ngForm">
         <p-tabView>
            
            <p-tabPanel header="Manager Approval">
                <div class="w-100">
                    <p-divider type="dashed"></p-divider>
        
                        <h2>Select your response:</h2>
                        <p-selectButton [options]="stateOptions" optionLabel="label" optionValue="value"
                            name="departmangconfirmStatus" [(ngModel)]="selectedSubRequest.departmangconfirmStatus" required>
                        </p-selectButton>
                        <div class="form-group mt-3">
                            <p-dropdown 
                            [appendTo]="'body'" 
                            [options]="ManagerList" 
                            name="deptManagId"
                            optionLabel="teNum" 
                            optionValue="id" 
                            [showClear]="true" 
                            [filter]="true" 
                            filterBy="teNum"
                            placeholder="Select the Depatment Manager"
                            [(ngModel)]="selectedSubRequest.deptManagId"
                   >
                        </p-dropdown>
                        </div>
                        <div *ngIf="form.submitted && !selectedSubRequest.departmangconfirmStatus" class="error-message">
                            Response is required.
                        </div>
                        <br>
                        <h2>Enter the cause:</h2>
                        <textarea rows="10" cols="70" pInputTextarea name="departmang_Not_confirmCause"
                            [(ngModel)]="selectedSubRequest.departmang_Not_confirmCause" required >
                        </textarea>
                </div>
            </p-tabPanel>
            <p-tabPanel header="Controller Approval">
                <div class="w-100">
                    <p-divider type="dashed"></p-divider>
        
                        <h2>Select your response:</h2>
                        <p-selectButton [options]="stateOptions" optionLabel="label" optionValue="value"
                            name="financeconfirmSatuts" [(ngModel)]="selectedSubRequest.financeconfirmSatuts" required>
                        </p-selectButton>
                        <div class="form-group mt-3">
                            <p-dropdown 
                            [appendTo]="'body'" 
                            [options]="ControllerList" 
                            name="controllerid"
                            optionLabel="teNum" 
                            optionValue="id" 
                            [showClear]="true" 
                            [filter]="true" 
                            filterBy="teNum"
                            placeholder="Select the Controller"
                            [(ngModel)]="selectedSubRequest.controllerid"

                   >
                        </p-dropdown>
                        </div>
                        <br>
                        <div class="container" *ngIf="selectedSubRequest.financeconfirmSatuts===true">
                            <p-divider align="left" type="solid"> <b>GL & CC & Order</b>
                            </p-divider>
        
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <input pInputText id="GL" aria-describedby="gl-help" name="gl" placeholder="GL"
                                        [(ngModel)]="selectedSubRequest.gl" class="form-control" />
                                </div>
                                <div class="col-md-4 mb-3">
                                    <input pInputText id="CC" aria-describedby="CC-help" name="cc" placeholder="CC"
                                        [(ngModel)]="selectedSubRequest.cc" class="form-control" />
                                </div>
                                <div class="col-md-4 mb-3">
                                    <input pInputText id="order" aria-describedby="order-help" placeholder="Order" name="order"
                                        [(ngModel)]="selectedSubRequest.order" class="form-control" />
        
                                </div>
                            </div>
                        </div>
                        <p-divider type="solid"> </p-divider>
        
                        <div *ngIf="form.submitted && !selectedSubRequest.financeconfirmSatuts" class="error-message">
                            Response is required.
                        </div>
                        <br>
                        <div *ngIf="selectedSubRequest.financeconfirmSatuts===false" class="col-md-4 mb-3">
                        <h2>Enter the cause:</h2>
                        <textarea rows="6" cols="50" pInputTextarea name="finance_Not_confirmCause"
                            [(ngModel)]="selectedSubRequest.finance_Not_confirmCause" required #cause="ngModel">
                        </textarea>
                        </div>
        
                </div>
            </p-tabPanel>
            <p-tabPanel header="PR">
                <div class="w-100">
                    <p-divider type="dashed"></p-divider>
        
                        <h2>Select your response:</h2>
                        <p-selectButton [options]="stateOptions" optionLabel="label" optionValue="value" name="pR_Status"
                            [(ngModel)]="selectedSubRequest.pR_Status" required>
                        </p-selectButton>
                        <div class="form-group mt-3">
                            <p-dropdown 
                            [appendTo]="'body'" 
                            [options]="ItApproversList" 
                            name="itId"
                            optionLabel="teNum" 
                            optionValue="id" 
                            [showClear]="true" 
                            [filter]="true" 
                            filterBy="teNum"
                            placeholder="Select the IT Approver"
                            [(ngModel)]="selectedSubRequest.itId"

                   >
                        </p-dropdown>
                        </div>
                        <div *ngIf="form.submitted && !selectedSubRequest.pR_Status" class="error-message">
                            Response is required.
                        </div>
                        <br>
        
                        <div *ngIf="selectedSubRequest.pR_Status===true">
                            <p-divider align="left" type="solid"> <b> PR</b>
                            </p-divider>
                            <div class="row">
                                <div class="col-4">
                                    <input type="text" pInputText [(ngModel)]="selectedSubRequest.prNum" name="prNum"
                                        placeholder="PR number" class="form-control" />
                                </div>
        
                            </div>
                            <p-divider type="dashed" />
                            <br>
                        </div> 
                        <div *ngIf="selectedSubRequest.pR_Status===false">
                        <h2>Enter the cause:</h2>
                        <textarea rows="10" cols="70" pInputTextarea name="pR_Not_ConfirmCause"
                            [(ngModel)]="selectedSubRequest.pR_Not_ConfirmCause" required #cause="ngModel">
                        </textarea>
                      </div>
        
        
                </div>
              
            </p-tabPanel>
            <p-tabPanel header="PO">
                <div class="w-100">

                    <div>
                        <p-divider align="left" type="solid"><b>PO</b></p-divider>
                        <div class="row">
                            <div class="form-group">
                                <input type="text" pInputText [(ngModel)]="selectedSubRequest.poNum" name="poNum"
                                    placeholder="PO number" class="form-control same-size-input" />
                            </div>
                            <p-divider align="left" type="solid"><b>Supplier</b></p-divider>
                            <div class="form-group mt-3">
                                <p-dropdown [filter]="true" filterBy="supplierName" [showClear]="true"
                                    [(ngModel)]="selectedSubRequest.supplierrid" [appendTo]="'body'" name="supplierrid"
                                    [options]="supliersNames" optionValue="supplierId" optionLabel="supplierName"
                                    aria-describedby="supplierName" placeholder="Select the Supplier Name"
                                    class="same-size-dropdown">
                                </p-dropdown>
                            </div>
                        </div>
                        <p-divider type="dashed"></p-divider>
                        <br>
                    </div>
                  
            </div>
            </p-tabPanel>
            <p-tabPanel header="Assignment">
                <div class="w-100">
                    <div *ngIf="selectedSubRequest.pR_Status === true">
                        <p-divider align="left" type="solid"><b>Employee</b></p-divider>
                        <div class="row">
                            <div class="row justify-content-center align-items-center text-center">
                                <p-avatar icon="pi pi-user" styleClass="mr-2" size="xlarge" />
                                <h3 class="mt-2">{{Mainrequest.nmaeOfUser}} </h3>
                            </div>
                           
                               
                            <p-divider type="solid"></p-divider>
                            <div class="form-group mt-3">
                                <p-checkbox   inputId="ny" [(ngModel)]="selectedSubRequest.receptionStatus" [binary]="true" name="receptionStatus" />
                                <label for="ny" class="ml-2"> Assign</label>
                            </div>
                            <div class="form-group d-flex align-items-center mt-3">
                                <div class="flex-grow-1 mr-2">
                                    <label class="mb-3" for="AssetSN">Assignment Date:</label><br>
    
                                    <p-calendar [iconDisplay]="'input'" [showIcon]="true" inputId="calendar-24h"
                                                [appendTo]="'body'" name="assetReceiveByEMployeAt"
                                                [(ngModel)]="selectedSubRequest.assetReceiveByEMployeAt" dateFormat="dd-mm-yy" [showTime]="true" [showButtonBar]="true"
                                                class="w-100"/>
                                </div>
                                <div class="flex-grow-1 mr-3">
                                    <label class="mb-3" for="AssetSN">Asset SN:</label> 
                                    <input type="text" pInputText [(ngModel)]="selectedSubRequest.assetSN" name="AssetSN"
                                           placeholder="Asset Serial Number" class="form-control"/>
                                </div>
                                <div class="flex-grow-1">
                                    <label class="mb-3" for="AssetSN">Asset Model:</label>
                                    <input type="text" pInputText [(ngModel)]="selectedSubRequest.assetModele" name="AssetModele"
                                           placeholder="Asset Modele" class="form-control"/>
                                </div>
                            </div>
    
                        </div>
                        <p-divider type="dashed"></p-divider>
                        <br>
                    </div>
                    <br>
                   
                   
            </div>
            </p-tabPanel> 
        </p-tabView>
        <div style="text-align: right;">
            <p-button type="submit" [outlined]="true" [disabled]="loading2 ">
                <ng-container *ngIf="!loading2; else loadingTemplate">
                    Confirm
                </ng-container>
                <ng-template #loadingTemplate>
                    <i class="pi pi-spinner pi-spin"></i> Loading...
                </ng-template>
            </p-button>
        </div>
    </form>

       
     
      
    </div>
</p-dialog>